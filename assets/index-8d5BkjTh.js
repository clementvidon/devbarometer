import{j as t,R as D,L as T,C as I,X as O,Y as M,T as B,a as R,r as l,c as P}from"./vendor-uy8bHOC1.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function w(){document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}function H(){w(),window.addEventListener("resize",w)}function $(o){if(!o||typeof o!="object")return!1;const r=o;return typeof r.createdAt=="string"&&typeof r.emotions=="object"&&r.emotions!==null}function Y(o){if(!Array.isArray(o)||!o.every($))throw new Error("Invalid chart.json shape")}const q="_chartContainer_1w5hl_1",z="_heading_1w5hl_17",K="_chart_1w5hl_1",U="_chartFooter_1w5hl_40",V="_legendCol_1w5hl_58",G="_controlCol_1w5hl_59",J="_legendItem_1w5hl_71",X="_controlItem_1w5hl_72",W="_colorDot_1w5hl_101",d={chartContainer:q,heading:z,chart:K,chartFooter:U,legendCol:V,controlCol:G,legendItem:J,controlItem:X,colorDot:W};function Q({view:o,onToggleView:r,hudVisible:e,onToggleHud:n}){return t.jsxs("div",{className:d.controlCol,children:[t.jsx("button",{type:"button",className:d.controlItem,onClick:r,children:o==="emotions"?"Voir tonalit√©s üìà":"Voir √©motions üìä"}),t.jsx("button",{type:"button",className:d.controlItem,"aria-pressed":e,onClick:n,title:e?"Masquer axes/valeurs":"Afficher axes/valeurs",children:e?"Masquer axes/valeurs ‚öôÔ∏è":"Afficher axes/valeurs ‚öôÔ∏è"}),t.jsx("button",{type:"button",className:d.controlItem,disabled:!0,title:"Rapport p√©riodique ‚Äî bient√¥t disponible",children:"S'abonner au rapport üì¶"})]})}const a={axisText:"#9ec3ff",axisLine:"#6b93c9",grid:"#2a4566",tooltipBg:"rgba(18, 34, 52, 0.96)",tooltipBorder:"#3a5f8f",tooltipText:"#dbeaff"},f={joy:"#B7C8FF",trust:"#B39EFF",fear:"#D00000",anger:"#D20054",disgust:"#7E0000",sadness:"#8B1F4D"},k=Object.keys(f),A={joy:"Joie",trust:"Confiance",fear:"Peur",anger:"Col√®re",disgust:"D√©go√ªt",sadness:"Tristesse"},y={polarity:"#FF3385",surprise:"#EA80FF",anticipation:"#7728FF"},L=Object.keys(y),N={polarity:"Valence",surprise:"Surprise",anticipation:"Anticipation"},Z=new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit"}),F=new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit"}),C=new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2});function E({data:o,hudVisible:r,tooltipActive:e,setTooltipActive:n,series:i}){return t.jsx("div",{className:d.chart,onPointerDown:()=>n(!0),onPointerUp:()=>n(!1),onPointerCancel:()=>n(!1),onPointerLeave:()=>n(!1),children:t.jsx(D,{width:"100%",height:"100%",children:t.jsxs(T,{data:o,children:[r&&t.jsx(I,{stroke:a.grid,strokeDasharray:"3 3",vertical:!1}),t.jsx(O,{dataKey:"createdAt",hide:!r,tick:{fill:a.axisText,fontSize:"var(--font-size-content)"},axisLine:{stroke:a.axisLine},tickLine:{stroke:a.axisLine},tickFormatter:s=>Z.format(new Date(s)),tickMargin:10}),t.jsx(M,{tickFormatter:s=>C.format(s),tickMargin:5,width:50,hide:!r,tick:{fill:a.axisText,fontSize:"var(--font-size-content)"},axisLine:{stroke:a.axisLine},tickLine:{stroke:a.axisLine},domain:["dataMin","dataMax"]}),t.jsx(B,{contentStyle:{backgroundColor:a.tooltipBg,border:`1px solid ${a.tooltipBorder}`,borderRadius:8},labelStyle:{color:a.tooltipText},itemStyle:{color:a.tooltipText},cursor:{stroke:a.axisLine,strokeDasharray:"3 3"},wrapperStyle:{display:e?"block":"none"},labelFormatter:s=>F.format(new Date(String(s))),formatter:(s,c)=>[C.format(s),c],itemSorter:s=>typeof s.value=="number"?-s.value:0}),i.map(s=>t.jsx(R,{type:"monotone",dataKey:s.key,stroke:s.color,strokeWidth:3,dot:!1,name:s.label??s.key,activeDot:e?{r:5}:!1},s.key))]})})})}function ee(o){const r=k.map(e=>({key:e,color:f[e],label:A[e]}));return t.jsx(E,{...o,series:r})}function te({mode:o="emotions"}){const r=o==="emotions"?k.map(e=>({key:String(e),color:f[e],label:A[e]})):L.map(e=>({key:String(e),color:y[e],label:N[e]}));return t.jsx("div",{className:d.legendCol,children:r.map(e=>t.jsxs("div",{className:d.legendItem,children:[t.jsx("span",{className:d.colorDot,style:{backgroundColor:e.color}}),t.jsx("span",{children:e.label})]},e.key))})}function oe(o){const r=L.map(e=>({key:e,color:y[e],label:N[e]}));return t.jsx(E,{...o,series:r})}function re(o){const r=Object.keys(f);return o.slice().sort((e,n)=>+new Date(e.createdAt)-+new Date(n.createdAt)).map(e=>{const n={};for(const i of r)n[i]=+(e.emotions[i]??0);return{dateLabel:F.format(new Date(e.createdAt)),createdAt:e.createdAt,...n}})}function ne(o){return o.slice().sort((r,e)=>+new Date(r.createdAt)-+new Date(e.createdAt)).map(r=>{const e=r.tonalities,n=(e==null?void 0:e.positive)??0,i=(e==null?void 0:e.negative)??0,s=(e==null?void 0:e.positive_surprise)??0,c=(e==null?void 0:e.negative_surprise)??0,x=(e==null?void 0:e.optimistic_anticipation)??0,h=(e==null?void 0:e.pessimistic_anticipation)??0;return{createdAt:r.createdAt,polarity:+(n-i),surprise:+(s-c),anticipation:+(x-h)}})}function se(){const[o,r]=l.useState(null),[e,n]=l.useState(null),[i,s]=l.useState("emotions"),[c,x]=l.useState(!1),[h,_]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const v=await(await fetch("chart.json")).json();Y(v);const b=v;r(re(b)),n(ne(b))}catch(u){console.error("Erreur lors du chargement des donn√©es:",u),r([]),n([])}})()},[]);const j=(o==null?void 0:o.length)??0;if(!o||!e)return t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement du graphique‚Ä¶"});const S=()=>s(u=>u==="emotions"?"tonalities":"emotions");return t.jsxs("div",{className:d.chartContainer,children:[t.jsx("p",{className:d.heading,children:i==="emotions"?`Intensit√© des √©motions ces ${j}¬† derniers jours.`:`Polarit√© des tonalit√©s ces ${j}¬† derniers jours.`}),i==="emotions"?t.jsx(ee,{data:o,hudVisible:c,tooltipActive:h,setTooltipActive:_}):t.jsx(oe,{data:e,hudVisible:c,tooltipActive:h,setTooltipActive:_}),t.jsxs("div",{className:d.chartFooter,children:[t.jsx("div",{children:t.jsx(te,{mode:i})}),t.jsx(Q,{view:i,onToggleView:S,hudVisible:c,onToggleHud:()=>x(u=>!u)})]})]})}const ie="_report_149pe_1",ae="_emoji_149pe_9",ce="_text_149pe_15",g={report:ie,emoji:ae,text:ce};function le(){const[o,r]=l.useState(null);return l.useEffect(()=>{fetch("/devbarometer/"+"report.json").then(n=>n.ok?n.json():null).then(n=>{r(n&&typeof n=="object"?n:null)})},[]),o?t.jsxs("div",{className:g.report,children:[t.jsx("div",{className:g.emoji,children:o.emoji}),t.jsx("p",{className:g.text,children:o.text})]}):t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement du rapport‚Ä¶"})}function de(o){return typeof o=="object"&&o!==null&&"title"in o&&"weight"in o&&"source"in o&&typeof o.title=="string"&&typeof o.weight=="number"&&typeof o.source=="string"}function ue(o){const r=o.slice();for(let e=r.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[r[e],r[n]]=[r[n],r[e]]}return r}const me="_ticker_18y2x_1",he="_row_18y2x_18",pe="_track_18y2x_22",fe="_item_18y2x_33",p={ticker:me,row:he,track:pe,item:fe};function xe(){const[o,r]=l.useState(null);return l.useEffect(()=>{fetch("/devbarometer/"+"ticker.json").then(n=>n.ok?n.json():[]).then(n=>{Array.isArray(n)&&n.every(de)?r(ue(n)):r([])}).catch(n=>{console.error("Error loading headlines:",n),r([])})},[]),o===null?t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement des titres‚Ä¶"}):o.length===0?t.jsx("p",{role:"status","aria-live":"polite",children:"Aucun titre charg√©."}):t.jsx("div",{className:p.ticker,children:t.jsx("div",{className:p.track,children:t.jsx("div",{className:p.row,children:[...o,...o].map(({title:e,source:n},i)=>t.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:p.item,children:['"',e,'"']},i))})})})}const ge="_navButton_eu9iu_1",ye="_heading_eu9iu_18",_e="_mainContent_eu9iu_29",je="_footer_eu9iu_39",m={navButton:ge,heading:ye,mainContent:_e,footer:je};function ve(){return t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:m.header,children:[t.jsx("h1",{className:m.heading,children:"DevBarometer"}),t.jsx("a",{href:"https://github.com/clementvidon/devbarometer",className:m.navButton,"aria-label":"Infos page",children:"√† propos"})]}),t.jsxs("main",{className:m.mainContent,children:[t.jsx(le,{}),t.jsx(xe,{}),t.jsx(se,{})]}),t.jsxs("footer",{className:m.footer,children:["Made with ‚ù§Ô∏è by",t.jsx("a",{href:"https://github.com/clementvidon/","aria-label":"Cl√©ment Vidon GitHub",children:" Cl√©ment Vidon "}),"¬∑ MIT License"]})]})}H();P.createRoot(document.getElementById("root")).render(t.jsx(l.StrictMode,{children:t.jsx(ve,{})}));
