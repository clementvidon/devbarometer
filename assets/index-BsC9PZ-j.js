import{j as t,R as E,L as S,C as D,X as I,Y as O,T as R,a as M,r as l,c as B}from"./vendor-uy8bHOC1.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();function b(){document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}function P(){b(),window.addEventListener("resize",b)}function H(o){if(!o||typeof o!="object")return!1;const r=o;return typeof r.createdAt=="string"&&typeof r.emotions=="object"&&r.emotions!==null}function $(o){if(!Array.isArray(o)||!o.every(H))throw new Error("Invalid chart.json shape")}const Y="_chartContainer_1isff_1",q="_heading_1isff_17",K="_chart_1isff_1",U="_chartFooter_1isff_40",V="_legendCol_1isff_58",G="_controlCol_1isff_59",J="_legendItem_1isff_71",X="_controlItem_1isff_72",z="_colorDot_1isff_101",d={chartContainer:Y,heading:q,chart:K,chartFooter:U,legendCol:V,controlCol:G,legendItem:J,controlItem:X,colorDot:z};function W({view:o,onToggleView:r,hudVisible:e,onToggleHud:s}){return t.jsxs("div",{className:d.controlCol,children:[t.jsx("button",{type:"button",className:d.controlItem,onClick:r,children:o==="emotions"?"Voir tonalit√©s üìà":"Voir √©motions üìä"}),t.jsx("button",{type:"button",className:d.controlItem,"aria-pressed":e,onClick:s,title:e?"Masquer axes/valeurs":"Afficher axes/valeurs",children:e?"Masquer axes/valeurs ‚öôÔ∏è":"Afficher axes/valeurs ‚öôÔ∏è"}),t.jsx("button",{type:"button",className:d.controlItem,disabled:!0,title:"Rapport p√©riodique ‚Äî bient√¥t disponible",children:"S'abonner au rapport üì¶"})]})}const a={axisText:"#9ec3ff",axisLine:"#6b93c9",grid:"#2a4566",tooltipBg:"rgba(18, 34, 52, 0.96)",tooltipBorder:"#3a5f8f",tooltipText:"#dbeaff"},h={joy:"#00FFFF",trust:"#00CFFF",fear:"#FF6600",anger:"#FF3300",disgust:"#FFCC66",sadness:"#FF9999"},F=Object.keys(h),w={joy:"Joie",trust:"Confiance",fear:"Peur",anger:"Col√®re",disgust:"D√©go√ªt",sadness:"Tristesse"},y={polarity:"#66FF66",surprise:"#FFD166",anticipation:"#7C83FF"},k=Object.keys(y),L={polarity:"Polarit√©",surprise:"Surprise",anticipation:"Anticipation"},Q=new Intl.DateTimeFormat("fr-FR",{year:"2-digit",month:"2-digit",day:"2-digit"}),N=new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),Z=new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2});function A({data:o,hudVisible:r,tooltipActive:e,setTooltipActive:s,series:n}){return t.jsx("div",{className:d.chart,onPointerDown:()=>s(!0),onPointerUp:()=>s(!1),onPointerCancel:()=>s(!1),onPointerLeave:()=>s(!1),children:t.jsx(E,{width:"100%",height:"100%",children:t.jsxs(S,{data:o,children:[r&&t.jsx(D,{stroke:a.grid,strokeDasharray:"3 3",vertical:!1}),t.jsx(I,{dataKey:"createdAt",hide:!r,tick:{fill:a.axisText},axisLine:{stroke:a.axisLine},tickLine:{stroke:a.axisLine},tickFormatter:i=>Q.format(new Date(i))}),t.jsx(O,{hide:!r,tick:{fill:a.axisText},axisLine:{stroke:a.axisLine},tickLine:{stroke:a.axisLine},domain:["dataMin","dataMax"]}),t.jsx(R,{contentStyle:{backgroundColor:a.tooltipBg,border:`1px solid ${a.tooltipBorder}`,borderRadius:8},labelStyle:{color:a.tooltipText},itemStyle:{color:a.tooltipText},cursor:{stroke:a.axisLine,strokeDasharray:"3 3"},wrapperStyle:{display:e?"block":"none"},labelFormatter:i=>N.format(new Date(String(i))),formatter:(i,c)=>[Z.format(i),c]}),n.map(i=>t.jsx(M,{type:"monotone",dataKey:i.key,stroke:i.color,strokeWidth:2,dot:!1,name:i.label??i.key,activeDot:e?{r:5}:!1},i.key))]})})})}function ee(o){const r=F.map(e=>({key:e,color:h[e],label:w[e]}));return t.jsx(A,{...o,series:r})}function te({mode:o="emotions"}){const r=o==="emotions"?F.map(e=>({key:String(e),color:h[e],label:w[e]})):k.map(e=>({key:String(e),color:y[e],label:L[e]}));return t.jsx("div",{className:d.legendCol,children:r.map(e=>t.jsxs("div",{className:d.legendItem,children:[t.jsx("span",{className:d.colorDot,style:{backgroundColor:e.color}}),t.jsx("span",{children:e.label})]},e.key))})}function oe(o){const r=k.map(e=>({key:e,color:y[e],label:L[e]}));return t.jsx(A,{...o,series:r})}function re(o){const r=Object.keys(h);return o.slice().sort((e,s)=>+new Date(e.createdAt)-+new Date(s.createdAt)).map(e=>{const s={};for(const n of r)s[n]=+(e.emotions[n]??0);return{dateLabel:N.format(new Date(e.createdAt)),createdAt:e.createdAt,...s}})}function se(o){return o.slice().sort((r,e)=>+new Date(r.createdAt)-+new Date(e.createdAt)).map(r=>{const e=r.tonalities,s=(e==null?void 0:e.positive)??0,n=(e==null?void 0:e.negative)??0,i=(e==null?void 0:e.positive_surprise)??0,c=(e==null?void 0:e.negative_surprise)??0,x=(e==null?void 0:e.optimistic_anticipation)??0,f=(e==null?void 0:e.pessimistic_anticipation)??0;return{createdAt:r.createdAt,polarity:+(s-n),surprise:+(i-c),anticipation:+(x-f)}})}function ne(){const[o,r]=l.useState(null),[e,s]=l.useState(null),[n,i]=l.useState("emotions"),[c,x]=l.useState(!1),[f,_]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const v=await(await fetch("chart.json")).json();$(v);const C=v;r(re(C)),s(se(C))}catch(u){console.error("Erreur lors du chargement des donn√©es:",u),r([]),s([])}})()},[]);const j=(o==null?void 0:o.length)??0;if(!o||!e)return t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement du graphique‚Ä¶"});const T=()=>i(u=>u==="emotions"?"tonalities":"emotions");return t.jsxs("div",{className:d.chartContainer,children:[t.jsx("p",{className:d.heading,children:n==="emotions"?`√âmotions des ${j}¬† derniers jours.`:`Tonalit√©s des ${j}¬† derniers jours.`}),n==="emotions"?t.jsx(ee,{data:o,hudVisible:c,tooltipActive:f,setTooltipActive:_}):t.jsx(oe,{data:e,hudVisible:c,tooltipActive:f,setTooltipActive:_}),t.jsxs("div",{className:d.chartFooter,children:[t.jsx("div",{children:t.jsx(te,{mode:n})}),t.jsx(W,{view:n,onToggleView:T,hudVisible:c,onToggleHud:()=>x(u=>!u)})]})]})}const ie="_report_149pe_1",ae="_emoji_149pe_9",ce="_text_149pe_15",g={report:ie,emoji:ae,text:ce};function le(){const[o,r]=l.useState(null);return l.useEffect(()=>{fetch("/devbarometer/"+"report.json").then(s=>s.ok?s.json():null).then(s=>{r(s&&typeof s=="object"?s:null)})},[]),o?t.jsxs("div",{className:g.report,children:[t.jsx("div",{className:g.emoji,children:o.emoji}),t.jsx("p",{className:g.text,children:o.text})]}):t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement du rapport‚Ä¶"})}function de(o){return typeof o=="object"&&o!==null&&"title"in o&&"weight"in o&&"source"in o&&typeof o.title=="string"&&typeof o.weight=="number"&&typeof o.source=="string"}function ue(o){const r=o.slice();for(let e=r.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[r[e],r[s]]=[r[s],r[e]]}return r}const me="_ticker_18y2x_1",fe="_row_18y2x_18",pe="_track_18y2x_22",he="_item_18y2x_33",p={ticker:me,row:fe,track:pe,item:he};function xe(){const[o,r]=l.useState(null);return l.useEffect(()=>{fetch("/devbarometer/"+"ticker.json").then(s=>s.ok?s.json():[]).then(s=>{Array.isArray(s)&&s.every(de)?r(ue(s)):r([])}).catch(s=>{console.error("Error loading headlines:",s),r([])})},[]),o===null?t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement des titres‚Ä¶"}):o.length===0?t.jsx("p",{role:"status","aria-live":"polite",children:"Aucun titre charg√©."}):t.jsx("div",{className:p.ticker,children:t.jsx("div",{className:p.track,children:t.jsx("div",{className:p.row,children:[...o,...o].map(({title:e,source:s},n)=>t.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:p.item,children:['"',e,'"']},n))})})})}const ge="_navButton_eu9iu_1",ye="_heading_eu9iu_18",_e="_mainContent_eu9iu_29",je="_footer_eu9iu_39",m={navButton:ge,heading:ye,mainContent:_e,footer:je};function ve(){return t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:m.header,children:[t.jsx("h1",{className:m.heading,children:"DevBarometer"}),t.jsx("a",{href:"https://github.com/clementvidon/devbarometer",className:m.navButton,"aria-label":"Infos page",children:"√† propos"})]}),t.jsxs("main",{className:m.mainContent,children:[t.jsx(le,{}),t.jsx(xe,{}),t.jsx(ne,{})]}),t.jsxs("footer",{className:m.footer,children:["Made with ‚ù§Ô∏è by",t.jsx("a",{href:"https://github.com/clementvidon/","aria-label":"Cl√©ment Vidon GitHub",children:" Cl√©ment Vidon "}),"¬∑ MIT License"]})]})}P();B.createRoot(document.getElementById("root")).render(t.jsx(l.StrictMode,{children:t.jsx(ve,{})}));
