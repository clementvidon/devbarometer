import{j as t,R as B,L as P,C as H,X as q,Y as $,T as Y,a as U,r as l,c as z}from"./vendor-uy8bHOC1.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();function N(){document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}function K(){N(),window.addEventListener("resize",N)}function X(r){if(!r||typeof r!="object")return!1;const n=r;return typeof n.createdAt=="string"&&typeof n.emotions=="object"&&n.emotions!==null}function V(r){if(!Array.isArray(r)||!r.every(X))throw new Error("Invalid chart.json shape")}const W="_chartContainer_pk6j8_1",G="_heading_pk6j8_17",J="_chart_pk6j8_1",Q="_chartFooter_pk6j8_40",Z="_legendCol_pk6j8_58",ee="_controlCol_pk6j8_59",te="_legendItem_pk6j8_71",re="_controlItem_pk6j8_72",ne="_colorDot_pk6j8_96",f={chartContainer:W,heading:G,chart:J,chartFooter:Q,legendCol:Z,controlCol:ee,legendItem:te,controlItem:re,colorDot:ne};function oe({view:r,onToggleView:n,hudVisible:e,onToggleHud:s}){return t.jsxs("div",{className:f.controlCol,children:[t.jsx("button",{type:"button",className:f.controlItem,onClick:n,children:r==="emotions"?"Voir tonalitÃ©s ğŸ“ˆ":"Voir Ã©motions ğŸ“Š"}),t.jsx("button",{type:"button",className:f.controlItem,"aria-pressed":e,onClick:s,title:e?"Masquer axes/valeurs":"Afficher axes/valeurs",children:e?"Masquer axes/valeurs âš™ï¸":"Afficher axes/valeurs âš™ï¸"}),t.jsx("button",{type:"button",className:f.controlItem,disabled:!0,title:"Rapport pÃ©riodique â€” bientÃ´t disponible",children:"S'abonner au rapport ğŸ“¦"})]})}const d={axisText:"#9ec3ff",axisLine:"#6b93c9",grid:"#2a4566",tooltipBg:"rgba(18, 34, 52, 0.96)",tooltipBorder:"#3a5f8f",tooltipText:"#dbeaff"},L={joy:"#B7C8FF",trust:"#B39EFF",fear:"#D00000",anger:"#D20054",disgust:"#7E0000",sadness:"#8B1F4D"},S=Object.keys(L),T={joy:"Joie",trust:"Confiance",fear:"Peur",anger:"ColÃ¨re",disgust:"DÃ©goÃ»t",sadness:"Tristesse"},D={polarity:"#FF3385",surprise:"#EA80FF",anticipation:"#7728FF"},I=Object.keys(D),R={polarity:"Valence",surprise:"Surprise",anticipation:"Anticipation"},se=new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit"}),O=new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit"}),F=new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2});function M({data:r,hudVisible:n,tooltipActive:e,setTooltipActive:s,series:a}){return t.jsx("div",{className:f.chart,onPointerDown:()=>s(!0),onPointerUp:()=>s(!1),onPointerCancel:()=>s(!1),onPointerLeave:()=>s(!1),children:t.jsx(B,{width:"100%",height:"100%",children:t.jsxs(P,{data:r,children:[n&&t.jsx(H,{stroke:d.grid,strokeDasharray:"3 3",vertical:!1}),t.jsx(q,{dataKey:"createdAt",hide:!n,tick:{fill:d.axisText,fontSize:"var(--font-size-content)"},axisLine:{stroke:d.axisLine},tickLine:{stroke:d.axisLine},tickFormatter:o=>se.format(new Date(o)),tickMargin:10}),t.jsx($,{tickFormatter:o=>F.format(o),tickMargin:5,width:50,hide:!n,tick:{fill:d.axisText,fontSize:"var(--font-size-content)"},axisLine:{stroke:d.axisLine},tickLine:{stroke:d.axisLine},domain:["dataMin","dataMax"]}),t.jsx(Y,{contentStyle:{backgroundColor:d.tooltipBg,border:`1px solid ${d.tooltipBorder}`,borderRadius:8},labelStyle:{color:d.tooltipText},itemStyle:{color:d.tooltipText},cursor:{stroke:d.axisLine,strokeDasharray:"3 3"},wrapperStyle:{display:e?"block":"none"},labelFormatter:o=>O.format(new Date(String(o))),formatter:(o,u)=>[F.format(o),u],itemSorter:o=>typeof o.value=="number"?-o.value:0}),a.map(o=>t.jsx(U,{type:"monotone",dataKey:o.key,stroke:o.color,strokeWidth:3,dot:!1,name:o.label??o.key,activeDot:e?{r:5}:!1},o.key))]})})})}function ae(r){const n=S.map(e=>({key:e,color:L[e],label:T[e]}));return t.jsx(M,{...r,series:n})}function ie({mode:r="emotions"}){const n=r==="emotions"?S.map(e=>({key:String(e),color:L[e],label:T[e]})):I.map(e=>({key:String(e),color:D[e],label:R[e]}));return t.jsx("div",{className:f.legendCol,children:n.map(e=>t.jsxs("div",{className:f.legendItem,children:[t.jsx("span",{className:f.colorDot,style:{backgroundColor:e.color}}),t.jsx("span",{children:e.label})]},e.key))})}function ce(r){const n=I.map(e=>({key:e,color:D[e],label:R[e]}));return t.jsx(M,{...r,series:n})}function le(r){const n=Object.keys(L);return r.slice().sort((e,s)=>+new Date(e.createdAt)-+new Date(s.createdAt)).map(e=>{const s={};for(const a of n)s[a]=+(e.emotions[a]??0);return{dateLabel:O.format(new Date(e.createdAt)),createdAt:e.createdAt,...s}})}function ue(r){return r.slice().sort((n,e)=>+new Date(n.createdAt)-+new Date(e.createdAt)).map(n=>{const e=n.tonalities,s=(e==null?void 0:e.positive)??0,a=(e==null?void 0:e.negative)??0,o=(e==null?void 0:e.positive_surprise)??0,u=(e==null?void 0:e.negative_surprise)??0,x=(e==null?void 0:e.optimistic_anticipation)??0,h=(e==null?void 0:e.pessimistic_anticipation)??0;return{createdAt:n.createdAt,polarity:+(s-a),surprise:+(o-u),anticipation:+(x-h)}})}function de(){const[r,n]=l.useState(null),[e,s]=l.useState(null),[a,o]=l.useState("emotions"),[u,x]=l.useState(!1),[h,j]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const b=await(await fetch("chart.json")).json();V(b);const w=b;n(le(w)),s(ue(w))}catch(m){console.error("Erreur lors du chargement des donnÃ©es:",m),n([]),s([])}})()},[]);const y=(r==null?void 0:r.length)??0;if(!r||!e)return t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement du graphiqueâ€¦"});const k=()=>o(m=>m==="emotions"?"tonalities":"emotions");return t.jsxs("div",{className:f.chartContainer,children:[t.jsx("p",{className:f.heading,children:a==="emotions"?`IntensitÃ© des Ã©motions â€“ ${y}Â jours.`:`PolaritÃ© des tonalitÃ©s â€“ ${y}Â jours.`}),a==="emotions"?t.jsx(ae,{data:r,hudVisible:u,tooltipActive:h,setTooltipActive:j}):t.jsx(ce,{data:e,hudVisible:u,tooltipActive:h,setTooltipActive:j}),t.jsxs("div",{className:f.chartFooter,children:[t.jsx("div",{children:t.jsx(ie,{mode:a})}),t.jsx(oe,{view:a,onToggleView:k,hudVisible:u,onToggleHud:()=>x(m=>!m)})]})]})}const fe="_report_149pe_1",pe="_emoji_149pe_9",me="_text_149pe_15",C={report:fe,emoji:pe,text:me};function he(){const[r,n]=l.useState(null);return l.useEffect(()=>{fetch("/devbarometer/"+"report.json").then(s=>s.ok?s.json():null).then(s=>{n(s&&typeof s=="object"?s:null)})},[]),r?t.jsxs("div",{className:C.report,children:[t.jsx("div",{className:C.emoji,children:r.emoji}),t.jsx("p",{className:C.text,children:r.text})]}):t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement du rapportâ€¦"})}function ge(r){return typeof r=="object"&&r!==null&&"title"in r&&"weight"in r&&"source"in r&&typeof r.title=="string"&&typeof r.weight=="number"&&typeof r.source=="string"}function xe(r){const n=r.slice();for(let e=n.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[n[e],n[s]]=[n[s],n[e]]}return n}const je="_ticker_96nsj_1",_e="_track_96nsj_18",ye="_dragging_96nsj_30",ve="_row_96nsj_30",ke="_item_96nsj_50",_={ticker:je,track:_e,dragging:ye,row:ve,item:ke},A=3,be=10;function we(){const[r,n]=l.useState(null),e=l.useRef(null),s=l.useRef(null),a=l.useRef(!1),o=l.useRef(!1),u=l.useRef(!1),x=l.useRef(0),h=l.useRef(0),j=l.useMemo(()=>r?xe(r):[],[r]),y=l.useMemo(()=>j.length?Array.from({length:A},()=>j).flat():[],[j]);l.useEffect(()=>{fetch("/devbarometer/"+"ticker.json").then(i=>i.ok?i.json():[]).then(i=>{Array.isArray(i)&&i.every(ge)?n(i):n([])}).catch(()=>n([]))},[]),l.useEffect(()=>{const c=e.current,i=s.current;if(!c||!i)return;const p=requestAnimationFrame(()=>{const g=i.scrollWidth/A;c.scrollLeft=g});return()=>cancelAnimationFrame(p)},[y.length]);const k=()=>{const c=e.current,i=s.current;if(!c||!i)return;const g=i.scrollWidth/A,E=24;c.scrollLeft<E?c.scrollLeft+=g:c.scrollLeft>g*2-E&&(c.scrollLeft-=g)},m=c=>{const i=e.current;if(!i)return;a.current=!0,o.current=!1,u.current=!1,x.current=c.clientX,h.current=i.scrollLeft,i.classList.add(_.dragging);const p=()=>{a.current=!1,o.current=!1,i.classList.remove(_.dragging),k(),window.removeEventListener("pointerup",p)};window.addEventListener("pointerup",p)},b=c=>{const i=e.current;if(!i||!a.current)return;const p=c.clientX-x.current;!o.current&&Math.abs(p)>be&&(o.current=!0,u.current=!0),o.current&&(i.scrollLeft=h.current-p,k(),c.preventDefault())},w=c=>{u.current&&(c.preventDefault(),c.stopPropagation())};return r===null?t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement des titresâ€¦"}):r.length===0?t.jsx("p",{role:"status","aria-live":"polite",children:"Aucun titre chargÃ©."}):t.jsx("div",{className:_.ticker,onPointerDown:m,onPointerMove:b,onClickCapture:w,children:t.jsx("div",{ref:e,className:_.track,children:t.jsx("div",{ref:s,className:_.row,children:y.map(({title:c,source:i,weight:p},g)=>t.jsxs("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:_.item,"aria-label":`Source: ${c}`,title:c,draggable:!1,children:["Â«",c,"Â»Â â‡§",p,"Â "]},g))})})})}const Le="_navButton_1c8qa_1",Ce="_heading_1c8qa_12",Ae="_mainContent_1c8qa_23",De="_footer_1c8qa_33",v={navButton:Le,heading:Ce,mainContent:Ae,footer:De};function Ee(){return t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:v.header,children:[t.jsx("h1",{className:v.heading,children:"DevBarometer"}),t.jsx("a",{className:v.navButton,href:"https://github.com/clementvidon/devbarometer","aria-label":"Infos page",target:"_blank",rel:"noopener noreferrer",children:"Ã  propos"})]}),t.jsxs("main",{className:v.mainContent,children:[t.jsx(he,{}),t.jsx(we,{}),t.jsx(de,{})]}),t.jsxs("footer",{className:v.footer,children:["Made with â¤ï¸ by",t.jsx("a",{href:"https://github.com/clementvidon/","aria-label":"Author's GitHub",target:"_blank",rel:"noopener noreferrer",children:" ClÃ©ment Vidon "}),"Â· MIT License"]})]})}K();z.createRoot(document.getElementById("root")).render(t.jsx(l.StrictMode,{children:t.jsx(Ee,{})}));
