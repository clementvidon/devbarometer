import{j as t,R as O,L as T,C as D,X as S,Y as R,T as I,a as B,r as d,c as M}from"./vendor-uy8bHOC1.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=e(r);fetch(r.href,i)}})();function w(){document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}function P(){w(),window.addEventListener("resize",w)}function $(o){if(!o||typeof o!="object")return!1;const n=o;return typeof n.createdAt=="string"&&typeof n.emotions=="object"&&n.emotions!==null}function H(o){if(!Array.isArray(o)||!o.every($))throw new Error("Invalid chart.json shape")}const Y="_chartContainer_yuyf8_1",K="_chart_yuyf8_1",U="_heading_yuyf8_27",V="_bottomRow_yuyf8_53",q="_legend_yuyf8_66",G="_gridOne_yuyf8_73",J="_column_yuyf8_78",X="_legendItem_yuyf8_84",z="_colorDot_yuyf8_90",W="_controls_yuyf8_97",Q="_controlButton_yuyf8_104",c={chartContainer:Y,chart:K,heading:U,bottomRow:V,legend:q,gridOne:G,column:J,legendItem:X,colorDot:z,controls:W,controlButton:Q},l={axisText:"#9ec3ff",axisLine:"#6b93c9",grid:"#2a4566",tooltipBg:"rgba(18, 34, 52, 0.96)",tooltipBorder:"#3a5f8f",tooltipText:"#dbeaff"},h={joy:"#00FFFF",trust:"#00CFFF",fear:"#FF6600",anger:"#FF3300",disgust:"#FFCC66",sadness:"#FF9999"},F=Object.keys(h),L={joy:"Joie",trust:"Confiance",fear:"Peur",anger:"Col√®re",disgust:"D√©go√ªt",sadness:"Tristesse"},g={polarity:"#66FF66",surprise:"#FFD166",anticipation:"#7C83FF"},C=Object.keys(g),N={polarity:"Polarit√©",surprise:"Surprise",anticipation:"Anticipation"},Z=new Intl.DateTimeFormat("fr-FR",{year:"2-digit",month:"2-digit",day:"2-digit"}),k=new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),ee=new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2});function A({data:o,hudVisible:n,tooltipActive:e,setTooltipActive:s,series:r}){return t.jsx("div",{className:c.chart,title:"Cliquer pour basculer de vue",onPointerDown:()=>s(!0),onPointerUp:()=>s(!1),onPointerCancel:()=>s(!1),onPointerLeave:()=>s(!1),children:t.jsx(O,{width:"100%",height:"100%",children:t.jsxs(T,{data:o,children:[n&&t.jsx(D,{stroke:l.grid,strokeDasharray:"3 3",vertical:!1}),t.jsx(S,{dataKey:"createdAt",hide:!n,tick:{fill:l.axisText},axisLine:{stroke:l.axisLine},tickLine:{stroke:l.axisLine},tickFormatter:i=>Z.format(new Date(i))}),t.jsx(R,{hide:!n,tick:{fill:l.axisText},axisLine:{stroke:l.axisLine},tickLine:{stroke:l.axisLine}}),t.jsx(I,{contentStyle:{backgroundColor:l.tooltipBg,border:`1px solid ${l.tooltipBorder}`,borderRadius:8},labelStyle:{color:l.tooltipText},itemStyle:{color:l.tooltipText},cursor:{stroke:l.axisLine,strokeDasharray:"3 3"},wrapperStyle:{display:e?"block":"none"},labelFormatter:i=>k.format(new Date(String(i))),formatter:(i,a)=>[ee.format(i),a]}),r.map(i=>t.jsx(B,{type:"monotone",dataKey:i.key,stroke:i.color,strokeWidth:2,dot:!1,name:i.label??i.key,activeDot:e?{r:5}:!1},i.key))]})})})}function te(o){const n=F.map(e=>({key:e,color:h[e],label:L[e]}));return t.jsx(A,{...o,series:n})}function oe({color:o,label:n}){return t.jsxs("div",{className:c.legendItem,children:[t.jsx("span",{className:c.colorDot,style:{backgroundColor:o}}),t.jsx("span",{children:n})]})}function ne({mode:o="emotions"}){const n=o==="emotions"?F.map(e=>({key:String(e),color:h[e],label:L[e]})):C.map(e=>({key:String(e),color:g[e],label:N[e]}));return t.jsx("div",{className:`${c.legend} ${c.gridOne}`,children:t.jsx("div",{className:c.column,children:n.map(e=>t.jsx(oe,{color:e.color,label:e.label},e.key))})})}function se(o){const n=C.map(e=>({key:e,color:g[e],label:N[e]}));return t.jsx(A,{...o,series:n})}function re(o){const n=Object.keys(h);return o.slice().sort((e,s)=>+new Date(e.createdAt)-+new Date(s.createdAt)).map(e=>{const s={};for(const r of n)s[r]=+(e.emotions[r]??0);return{dateLabel:k.format(new Date(e.createdAt)),createdAt:e.createdAt,...s}})}function ie(o){return o.slice().sort((n,e)=>+new Date(n.createdAt)-+new Date(e.createdAt)).map(n=>{const e=n.tonalities,s=(e==null?void 0:e.positive)??0,r=(e==null?void 0:e.negative)??0,i=(e==null?void 0:e.positive_surprise)??0,a=(e==null?void 0:e.negative_surprise)??0,y=(e==null?void 0:e.optimistic_anticipation)??0,f=(e==null?void 0:e.pessimistic_anticipation)??0;return{createdAt:n.createdAt,polarity:+(s-r).toFixed(3),surprise:+(i-a).toFixed(3),anticipation:+(y-f).toFixed(3)}})}function ae(){const[o,n]=d.useState(null),[e,s]=d.useState(null),[r,i]=d.useState("emotions"),[a,y]=d.useState(!1),[f,_]=d.useState(!1);d.useEffect(()=>{(async()=>{try{const b=await(await fetch("chart.json")).json();H(b);const v=b;n(re(v)),s(ie(v))}catch(u){console.error("Erreur lors du chargement des donn√©es:",u),n([]),s([])}})()},[]);const j=(o==null?void 0:o.length)??0;if(!o||!e)return t.jsx("p",{children:"Loading chart‚Ä¶"});const E=()=>i(u=>u==="emotions"?"tonalities":"emotions");return t.jsxs("div",{className:c.chartContainer,children:[r==="emotions"?t.jsx(te,{data:o,hudVisible:a,tooltipActive:f,setTooltipActive:_}):t.jsx(se,{data:e,hudVisible:a,tooltipActive:f,setTooltipActive:_}),t.jsx("p",{className:c.heading,children:r==="emotions"?`√âmotions des ${j}¬† derniers jours.`:`Tonalit√©s des ${j}¬† derniers jours.`}),t.jsxs("div",{className:c.bottomRow,children:[t.jsx("div",{children:t.jsx(ne,{mode:r})}),t.jsxs("div",{className:c.controls,children:[t.jsx("button",{type:"button",className:c.controlButton,onClick:E,children:r==="emotions"?"Voir tonalit√©s üìà":"Voir √©motions üìä"}),t.jsx("button",{type:"button",className:c.controlButton,"aria-pressed":a,onClick:()=>y(u=>!u),title:a?"Masquer axes/valeurs":"Afficher axes/valeurs",children:a?"Masquer axes/valeurs ‚öôÔ∏è":"Afficher axes/valeurs ‚öôÔ∏è"}),t.jsx("button",{type:"button",className:c.controlButton,disabled:!0,title:"Rapport bimensuel ‚Äî bient√¥t disponible",children:"Rapport bimensuel üì¶"})]})]})]})}const ce="_report_149pe_1",le="_emoji_149pe_9",de="_text_149pe_15",x={report:ce,emoji:le,text:de};function ue(){const[o,n]=d.useState(null);return d.useEffect(()=>{fetch("/devbarometer/"+"report.json").then(s=>s.ok?s.json():null).then(s=>{n(s&&typeof s=="object"?s:null)})},[]),o?t.jsxs("div",{className:x.report,children:[t.jsx("div",{className:x.emoji,children:o.emoji}),t.jsx("p",{className:x.text,children:o.text})]}):t.jsx("p",{children:"Loading‚Ä¶"})}function me(o){return typeof o=="object"&&o!==null&&"title"in o&&"weight"in o&&"source"in o&&typeof o.title=="string"&&typeof o.weight=="number"&&typeof o.source=="string"}function fe(o){const n=o.slice();for(let e=n.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[n[e],n[s]]=[n[s],n[e]]}return n}const pe="_ticker_18y2x_1",he="_row_18y2x_18",ye="_track_18y2x_22",xe="_item_18y2x_33",p={ticker:pe,row:he,track:ye,item:xe};function ge(){const[o,n]=d.useState(null);return d.useEffect(()=>{fetch("/devbarometer/"+"ticker.json").then(s=>s.ok?s.json():[]).then(s=>{Array.isArray(s)&&s.every(me)?n(fe(s)):n([])}).catch(s=>{console.error("Error loading headlines:",s),n([])})},[]),o===null?t.jsx("p",{children:"Chargement‚Ä¶"}):o.length===0?t.jsx("p",{children:"Aucun titre charg√©."}):t.jsx("div",{className:p.ticker,children:t.jsx("div",{className:p.track,children:t.jsx("div",{className:p.row,children:[...o,...o].map(({title:e,source:s},r)=>t.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:p.item,children:['"',e,'"']},r))})})})}const _e="_navButton_eu9iu_1",je="_heading_eu9iu_18",be="_mainContent_eu9iu_29",ve="_footer_eu9iu_39",m={navButton:_e,heading:je,mainContent:be,footer:ve};function we(){return t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:m.header,children:[t.jsx("h1",{className:m.heading,children:"DevBarometer"}),t.jsx("a",{href:"https://github.com/clementvidon/devbarometer",className:m.navButton,"aria-label":"Infos page",children:"√† propos"})]}),t.jsxs("main",{className:m.mainContent,children:[t.jsx(ue,{}),t.jsx(ge,{}),t.jsx(ae,{})]}),t.jsxs("footer",{className:m.footer,children:["Made with ‚ù§Ô∏è by",t.jsx("a",{href:"https://github.com/clementvidon/","aria-label":"Cl√©ment Vidon GitHub",children:" Cl√©ment Vidon "}),"¬∑ MIT License"]})]})}P();M.createRoot(document.getElementById("root")).render(t.jsx(d.StrictMode,{children:t.jsx(we,{})}));
