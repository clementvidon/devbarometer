import{j as t,R as S,L as T,C as I,X as R,Y as O,T as M,a as B,r as c,c as P}from"./vendor-uy8bHOC1.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();function C(){document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}function H(){C(),window.addEventListener("resize",C)}function $(r){if(!r||typeof r!="object")return!1;const n=r;return typeof n.createdAt=="string"&&typeof n.emotions=="object"&&n.emotions!==null}function Y(r){if(!Array.isArray(r)||!r.every($))throw new Error("Invalid chart.json shape")}const U="_chartContainer_1w5hl_1",q="_heading_1w5hl_17",z="_chart_1w5hl_1",K="_chartFooter_1w5hl_40",V="_legendCol_1w5hl_58",X="_controlCol_1w5hl_59",G="_legendItem_1w5hl_71",J="_controlItem_1w5hl_72",W="_colorDot_1w5hl_101",f={chartContainer:U,heading:q,chart:z,chartFooter:K,legendCol:V,controlCol:X,legendItem:G,controlItem:J,colorDot:W};function Q({view:r,onToggleView:n,hudVisible:e,onToggleHud:i}){return t.jsxs("div",{className:f.controlCol,children:[t.jsx("button",{type:"button",className:f.controlItem,onClick:n,children:r==="emotions"?"Voir tonalit√©s üìà":"Voir √©motions üìä"}),t.jsx("button",{type:"button",className:f.controlItem,"aria-pressed":e,onClick:i,title:e?"Masquer axes/valeurs":"Afficher axes/valeurs",children:e?"Masquer axes/valeurs ‚öôÔ∏è":"Afficher axes/valeurs ‚öôÔ∏è"}),t.jsx("button",{type:"button",className:f.controlItem,disabled:!0,title:"Rapport p√©riodique ‚Äî bient√¥t disponible",children:"S'abonner au rapport üì¶"})]})}const d={axisText:"#9ec3ff",axisLine:"#6b93c9",grid:"#2a4566",tooltipBg:"rgba(18, 34, 52, 0.96)",tooltipBorder:"#3a5f8f",tooltipText:"#dbeaff"},v={joy:"#B7C8FF",trust:"#B39EFF",fear:"#D00000",anger:"#D20054",disgust:"#7E0000",sadness:"#8B1F4D"},k=Object.keys(v),E={joy:"Joie",trust:"Confiance",fear:"Peur",anger:"Col√®re",disgust:"D√©go√ªt",sadness:"Tristesse"},b={polarity:"#FF3385",surprise:"#EA80FF",anticipation:"#7728FF"},A=Object.keys(b),N={polarity:"Valence",surprise:"Surprise",anticipation:"Anticipation"},Z=new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit"}),D=new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit"}),L=new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2});function F({data:r,hudVisible:n,tooltipActive:e,setTooltipActive:i,series:s}){return t.jsx("div",{className:f.chart,onPointerDown:()=>i(!0),onPointerUp:()=>i(!1),onPointerCancel:()=>i(!1),onPointerLeave:()=>i(!1),children:t.jsx(S,{width:"100%",height:"100%",children:t.jsxs(T,{data:r,children:[n&&t.jsx(I,{stroke:d.grid,strokeDasharray:"3 3",vertical:!1}),t.jsx(R,{dataKey:"createdAt",hide:!n,tick:{fill:d.axisText,fontSize:"var(--font-size-content)"},axisLine:{stroke:d.axisLine},tickLine:{stroke:d.axisLine},tickFormatter:o=>Z.format(new Date(o)),tickMargin:10}),t.jsx(O,{tickFormatter:o=>L.format(o),tickMargin:5,width:50,hide:!n,tick:{fill:d.axisText,fontSize:"var(--font-size-content)"},axisLine:{stroke:d.axisLine},tickLine:{stroke:d.axisLine},domain:["dataMin","dataMax"]}),t.jsx(M,{contentStyle:{backgroundColor:d.tooltipBg,border:`1px solid ${d.tooltipBorder}`,borderRadius:8},labelStyle:{color:d.tooltipText},itemStyle:{color:d.tooltipText},cursor:{stroke:d.axisLine,strokeDasharray:"3 3"},wrapperStyle:{display:e?"block":"none"},labelFormatter:o=>D.format(new Date(String(o))),formatter:(o,l)=>[L.format(o),l],itemSorter:o=>typeof o.value=="number"?-o.value:0}),s.map(o=>t.jsx(B,{type:"monotone",dataKey:o.key,stroke:o.color,strokeWidth:3,dot:!1,name:o.label??o.key,activeDot:e?{r:5}:!1},o.key))]})})})}function ee(r){const n=k.map(e=>({key:e,color:v[e],label:E[e]}));return t.jsx(F,{...r,series:n})}function te({mode:r="emotions"}){const n=r==="emotions"?k.map(e=>({key:String(e),color:v[e],label:E[e]})):A.map(e=>({key:String(e),color:b[e],label:N[e]}));return t.jsx("div",{className:f.legendCol,children:n.map(e=>t.jsxs("div",{className:f.legendItem,children:[t.jsx("span",{className:f.colorDot,style:{backgroundColor:e.color}}),t.jsx("span",{children:e.label})]},e.key))})}function re(r){const n=A.map(e=>({key:e,color:b[e],label:N[e]}));return t.jsx(F,{...r,series:n})}function ne(r){const n=Object.keys(v);return r.slice().sort((e,i)=>+new Date(e.createdAt)-+new Date(i.createdAt)).map(e=>{const i={};for(const s of n)i[s]=+(e.emotions[s]??0);return{dateLabel:D.format(new Date(e.createdAt)),createdAt:e.createdAt,...i}})}function oe(r){return r.slice().sort((n,e)=>+new Date(n.createdAt)-+new Date(e.createdAt)).map(n=>{const e=n.tonalities,i=(e==null?void 0:e.positive)??0,s=(e==null?void 0:e.negative)??0,o=(e==null?void 0:e.positive_surprise)??0,l=(e==null?void 0:e.negative_surprise)??0,x=(e==null?void 0:e.optimistic_anticipation)??0,h=(e==null?void 0:e.pessimistic_anticipation)??0;return{createdAt:n.createdAt,polarity:+(i-s),surprise:+(o-l),anticipation:+(x-h)}})}function se(){const[r,n]=c.useState(null),[e,i]=c.useState(null),[s,o]=c.useState("emotions"),[l,x]=c.useState(!1),[h,u]=c.useState(!1);c.useEffect(()=>{(async()=>{try{const _=await(await fetch("chart.json")).json();Y(_);const y=_;n(ne(y)),i(oe(y))}catch(m){console.error("Erreur lors du chargement des donn√©es:",m),n([]),i([])}})()},[]);const a=(r==null?void 0:r.length)??0;if(!r||!e)return t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement du graphique‚Ä¶"});const p=()=>o(m=>m==="emotions"?"tonalities":"emotions");return t.jsxs("div",{className:f.chartContainer,children:[t.jsx("p",{className:f.heading,children:s==="emotions"?`Intensit√© des √©motions ‚Äî ${a}¬†jours.`:`Polarit√© des tonalit√©s ‚Äî ${a}¬†jours.`}),s==="emotions"?t.jsx(ee,{data:r,hudVisible:l,tooltipActive:h,setTooltipActive:u}):t.jsx(re,{data:e,hudVisible:l,tooltipActive:h,setTooltipActive:u}),t.jsxs("div",{className:f.chartFooter,children:[t.jsx("div",{children:t.jsx(te,{mode:s})}),t.jsx(Q,{view:s,onToggleView:p,hudVisible:l,onToggleHud:()=>x(m=>!m)})]})]})}const ie="_report_149pe_1",ae="_emoji_149pe_9",ce="_text_149pe_15",w={report:ie,emoji:ae,text:ce};function le(){const[r,n]=c.useState(null);return c.useEffect(()=>{fetch("/devbarometer/"+"report.json").then(i=>i.ok?i.json():null).then(i=>{n(i&&typeof i=="object"?i:null)})},[]),r?t.jsxs("div",{className:w.report,children:[t.jsx("div",{className:w.emoji,children:r.emoji}),t.jsx("p",{className:w.text,children:r.text})]}):t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement du rapport‚Ä¶"})}function ue(r){return typeof r=="object"&&r!==null&&"title"in r&&"weight"in r&&"source"in r&&typeof r.title=="string"&&typeof r.weight=="number"&&typeof r.source=="string"}function de(r){const n=r.slice();for(let e=n.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[n[e],n[i]]=[n[i],n[e]]}return n}const fe="_ticker_64fhh_1",me="_track_64fhh_15",he="_dragging_64fhh_29",pe="_row_64fhh_29",ge="_item_64fhh_49",g={ticker:fe,track:me,dragging:he,row:pe,item:ge};function xe(){const[r,n]=c.useState(null),e=c.useRef(null),i=c.useRef(!1),s=c.useRef(!1),o=c.useRef(0),l=c.useRef(0);c.useEffect(()=>{fetch("/devbarometer/"+"ticker.json").then(a=>a.ok?a.json():[]).then(a=>{Array.isArray(a)&&a.every(ue)?n(de(a)):n([])}).catch(a=>{console.error("Error loading headlines:",a),n([])})},[]);const x=u=>{if(u.button!==0)return;const a=e.current;if(!a)return;i.current=!0,s.current=!1,o.current=u.clientX,l.current=a.scrollLeft;const p=_=>{if(!i.current||!a)return;const y=_.clientX-o.current;!s.current&&Math.abs(y)>3&&(s.current=!0,a.classList.add(g.dragging)),s.current&&(a.scrollLeft=l.current-y,_.preventDefault())},m=()=>{i.current=!1,s.current=!1,a&&a.classList.remove(g.dragging),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",m)};window.addEventListener("mousemove",p,{passive:!1}),window.addEventListener("mouseup",m),u.preventDefault()},h=u=>{s.current&&(u.preventDefault(),u.stopPropagation())};return r===null?t.jsx("p",{role:"status","aria-live":"polite",children:"Chargement des titres‚Ä¶"}):r.length===0?t.jsx("p",{role:"status","aria-live":"polite",children:"Aucun titre charg√©."}):t.jsx("div",{className:g.ticker,children:t.jsx("div",{ref:e,className:g.track,onMouseDown:x,onClickCapture:h,children:t.jsx("div",{className:g.row,children:[...r,...r].map(({title:u,source:a},p)=>t.jsxs("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:g.item,draggable:!1,children:["‚Äú",u,"‚Äù"]},p))})})})}const _e="_navButton_eu9iu_1",ye="_heading_eu9iu_18",je="_mainContent_eu9iu_29",ve="_footer_eu9iu_39",j={navButton:_e,heading:ye,mainContent:je,footer:ve};function we(){return t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:j.header,children:[t.jsx("h1",{className:j.heading,children:"DevBarometer"}),t.jsx("a",{href:"https://github.com/clementvidon/devbarometer",className:j.navButton,"aria-label":"Infos page",children:"√† propos"})]}),t.jsxs("main",{className:j.mainContent,children:[t.jsx(le,{}),t.jsx(xe,{}),t.jsx(se,{})]}),t.jsxs("footer",{className:j.footer,children:["Made with ‚ù§Ô∏è by",t.jsx("a",{href:"https://github.com/clementvidon/","aria-label":"Cl√©ment Vidon GitHub",children:" Cl√©ment Vidon "}),"¬∑ MIT License"]})]})}H();P.createRoot(document.getElementById("root")).render(t.jsx(c.StrictMode,{children:t.jsx(we,{})}));
